import{e,m as t,E as l,G as a,H as o,h as i,o as n,a as s,n as r,q as u,p as c,z as v,A as d,f,C as m,I as p,D as h,F as g,k as y,t as b,J as x}from"./index-CA6UagU_.js";import{F as H}from"./index.Budg9xHA.js";import{u as T}from"./use-provide.B_f5e336.js";import{u as k}from"./use-parent.Dwjp3nL8.js";const M=H({element:{root:"relative flex-1 h-full overflow-hidden touch-pan-y",scrollWrapper:"flex flex-col items-center will-change-transform transform-gpu backface-hidden transition-property-transform ease-out",option:"w-full flex-center text-body-medium select-none",optionText:"text-center truncate"},variants:{transitioning:{true:{scrollWrapper:"duration-400"},false:{}},selected:{true:{option:"text-brand font-bold"},false:{}},disabled:{true:{root:"cursor-not-allowed"},false:{root:"cursor-grab"}}},defaults:{disabled:!1,selected:!1}}),Y=H({element:{root:"relative w-full overflow-hidden",mask:"absolute top-0 left-0 size-full z-1 translate-z-0 flex flex-col pointer-events-none backface-hidden",gradient:"h-full from-surface to-surface/75",indicator:"flex-none bg-accent/20",rollers:"flex flex-row h-full overflow-hidden"},variants:{}}),w=Symbol("sk-roller-group"),D=e({__name:"sk-roller-group",props:{itemHeight:{default:44},visibleItemCount:{default:5},clax:{}},setup(e){const v=e,d=t(()=>Y(v)),f=t(()=>v.itemHeight*v.visibleItemCount),m=l({props:a({itemHeight:o(()=>v.itemHeight),visibleItemCount:o(()=>v.visibleItemCount)})});return T(w)(m),(e,t)=>(n(),i("div",{class:r(d.value.root()),style:u({height:`${f.value}px`})},[s("div",{class:r(d.value.mask())},[s("div",{class:r(d.value.gradient({clax:"bg-gradient-to-b"}))},null,2),s("div",{class:r(d.value.indicator()),style:u({height:`${e.itemHeight}px`})},null,6),s("div",{class:r(d.value.gradient({clax:"bg-gradient-to-t"}))},null,2)],2),s("div",{class:r(d.value.rollers())},[c(e.$slots,"default")],2)],6))}});function I(e,t,l){return Math.min(Math.max(e,t),l)}const C={friction:.002,minVelocity:.05,velocityHistoryTime:80};function A(e,t=C){const l=-1*function(e,t=C){const l=Date.now();if(e.velocityHistory=e.velocityHistory.filter(e=>l-e.time<=t.velocityHistoryTime),0===e.velocityHistory.length)return e.velocity;let a=0,o=0;return e.velocityHistory.forEach((e,t)=>{const l=t+1;a+=l,o+=e.velocity*l}),a>0?o/a:e.velocity}(e,t);return Math.abs(l)<t.minVelocity?0:l*l/(2*t.friction)*Math.sign(l)}const N=e({inheritAttrs:!1,options:{virtualHost:!0},__name:"sk-roller",props:v({options:{},disabled:{type:Boolean,default:!1},clax:{}},{modelValue:{},modelModifiers:{}}),emits:v(["change"],["update:modelValue"]),setup(e,{emit:l}){const a=e,o=d(e,"modelValue"),v=l,{parent:H}=k(w);let T;var Y;(Y=T||(T={})).NONE="none",Y.CLICK="click",Y.AUTO_ALIGN="auto",Y.INERTIA="inertia",Y.BOUNDARY="boundary",Y.SNAP="snap";const D=t(()=>M({...a})),C=t(()=>(null==H?void 0:H.props.itemHeight)||44),N=t(()=>(null==H?void 0:H.props.visibleItemCount)||4),O=f(0),$=t(()=>(N.value-1)/2*C.value),_={startY:0,startOffset:0,isDragging:!1,lastY:0,lastTime:0,velocity:0,velocityHistory:[]},V=f(!1);let j=null,z=null;const E=t(()=>a.options.length),F=t(()=>(E.value-1)*C.value),S=t(()=>{const e=a.options.findIndex(e=>e.value===o.value);return e>=0?e:0});function W(e,t="none",l){const{offset:a,index:o}=function(e){const t=I(e,0,F.value),l=I(Math.round(t/C.value),0,E.value-1);return{index:l,offset:l*C.value}}(e);if("none"===t)return O.value=a,void(null==l||l({offset:a,index:o,duration:0}));const i=function(e,t){const l=Math.abs(t);switch(e){case"click":return Math.min(300,Math.max(200,.5*l));case"auto":return Math.min(350,Math.max(250,.3*l));case"inertia":return 400;case"boundary":default:return 300;case"snap":return Math.min(250,Math.max(150,.4*l))}}(t,a-O.value);V.value=!0,h(()=>{O.value=a,j=setTimeout(()=>{V.value=!1,j=null},i)}),null==l||l({offset:a,index:o,duration:i})}function q(e){if(a.disabled)return;const t=e.touches[0];if(!t)return;V.value&&(V.value=!1),j&&(clearTimeout(j),j=null),z&&(cancelAnimationFrame(z),z=null);const l=Date.now();_.startY=t.clientY,_.startOffset=O.value,_.isDragging=!0,_.lastY=t.clientY,_.lastTime=l,_.velocity=0,_.velocityHistory=[]}function B(e){if(a.disabled||!_.isDragging)return;const t=e.touches[0];if(!t)return;const l=Date.now(),o=l-_.lastTime;if(o>5){const e=t.clientY-_.lastY;_.velocity=e/o,_.velocityHistory.push({velocity:_.velocity,time:l}),_.velocityHistory.length>10&&_.velocityHistory.shift(),_.lastY=t.clientY,_.lastTime=l}const i=t.clientY-_.startY,n=_.startOffset-i;let s=n;if(n<0){s=0-.3*(0-n)}else if(n>F.value){const e=n-F.value;s=F.value+.3*e}O.value=s}const G=({index:e})=>{var t;t=()=>{!function(e){const t=a.options[e];t&&!t.disabled&&t.value!==o.value&&(o.value=t.value,v("change",t.value,t))}(e),z=null},z=requestAnimationFrame(t)};function L(){if(a.disabled||!_.isDragging)return;if(_.isDragging=!1,O.value<0||O.value>F.value)return void W(O.value,"boundary",G);const e=A(_);Math.abs(e)>0?W(O.value+e,"inertia",G):W(O.value,"snap",G)}return m(S,e=>{h(()=>{W(e*C.value)})}),p(()=>{h(()=>{W(S.value*C.value)})}),(e,t)=>(n(),i("div",{class:r(D.value.root()),onTouchstart:q,onTouchmove:x(B,["stop","prevent"]),onTouchend:L,onTouchcancel:L},[s("div",{class:r(D.value.scrollWrapper({transitioning:V.value})),style:u({transform:`translate3d(0, ${-O.value+$.value}px, 0)`})},[(n(!0),i(g,null,y(a.options,(t,l)=>(n(),i("div",{key:t.value,class:r(D.value.option({selected:l===S.value,disabled:t.disabled||a.disabled})),style:u({height:`${C.value}px`}),onClick:e=>function(e,t){a.disabled||e.disabled||_.isDragging||W(t*C.value,"click",G)}(t,l)},[c(e.$slots,"option",{option:t,selected:l===S.value},()=>[s("span",{class:r(D.value.optionText())},b(t.label),3)])],14,["onClick"]))),128))],6)],34))}});export{D as _,N as a};
